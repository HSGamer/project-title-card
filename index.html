<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project Title Generator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="generate.js"></script>
</head>
<body class="container">
<form class="form-group" id="svgOptionsForm">
    <label class="form-label" for="title">Title</label>
    <input class="form-control" id="title" name="title" type="text" value="MaskedGUI">

    <label class="form-label" for="description">Description</label>
    <textarea class="form-control" id="description" name="description" rows="4">Description</textarea>

    <label class="form-label" for="backgroundStyle">Background Style</label>
    <input class="form-control" id="backgroundStyle" name="backgroundStyle"
           type="text" value="fill:white; stroke:green; stroke-width:2; fill-opacity:1">

    <label class="form-label" for="borderRadius">Border Radius</label>
    <input class="form-control" id="borderRadius" name="borderRadius"
           type="number" value="10">

    <label class="form-label" for="borderMargin">Border Margin</label>
    <input class="form-control" id="borderMargin" name="borderMargin"
           type="number" value="10">

    <label class="form-label" for="imageLink">Image Link</label>
    <input class="form-control" id="imageLink" name="imageLink"
           type="text"
           value="https://raw.githubusercontent.com/BetterGUI-MC/MaskedGUI/master/.github/image/logo.svg">

    <label class="form-label" for="titleStyle">Title Style</label>
    <input class="form-control" id="titleStyle" name="titleStyle" type="text"
           value="fill: black; font-weight: bold; font-family: Verdana;">

    <label class="form-label" for="descriptionStyle">Description Style</label>
    <input class="form-control" id="descriptionStyle" name="descriptionStyle" type="text"
           value="fill: black; font-family: Verdana;">

    <input id="btnReview" class="btn btn-primary mt-3" type="button" value="Review">
    <input id="btnDownload" class="btn btn-secondary mt-3" type="button" value="Download">
    <input id="btnDownloadPNG" class="btn btn-secondary mt-3" type="button" value="Download PNG">
</form>

<!-- SVG Review -->
<div id="svgContainer" class="mt-3"></div>

<script>
    async function generateSVGFromForm() {
        let options = {}
        options.backgroundStyle = document.getElementById('backgroundStyle').value;
        options.borderRadius = document.getElementById('borderRadius').value;
        options.borderMargin = document.getElementById('borderMargin').value;
        options.imageLink = document.getElementById('imageLink').value;
        options.title = document.getElementById('title').value;
        options.titleStyle = document.getElementById('titleStyle').value;
        options.description = document.getElementById('description').value;
        options.descriptionStyle = document.getElementById('descriptionStyle').value;
        return await generateSVG(options);
    }

    async function previewSVG() {
        let svg = await generateSVGFromForm();
        document.getElementById('svgContainer').innerHTML = new XMLSerializer().serializeToString(svg);
    }

    async function downloadSVG() {
        let svg = await generateSVGFromForm();
        let svgData = new XMLSerializer().serializeToString(svg);
        let blob = new Blob([svgData], {type: "image/svg+xml"});
        let url = URL.createObjectURL(blob);
        let a = document.createElement('a');
        a.href = url;
        a.download = 'Card.svg';
        a.click();
        URL.revokeObjectURL(url);
    }

    async function downloadPNG() {
        let svg = await generateSVGFromForm();
        let svgData = new XMLSerializer().serializeToString(svg);
        let blob = new Blob([svgData], {type: "image/svg+xml"});
        let url = URL.createObjectURL(blob);
        let img = new Image();
        img.src = url;
        img.onload = function () {
            let canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            let ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            canvas.toBlob(function (blob) {
                let url = URL.createObjectURL(blob);
                let a = document.createElement('a');
                a.href = url;
                a.download = 'Card.png';
                a.click();
                URL.revokeObjectURL(url);
            });
        }
    }

    document.getElementById('btnReview').addEventListener('click', previewSVG);
    document.getElementById('btnDownload').addEventListener('click', downloadSVG);
    document.getElementById('btnDownloadPNG').addEventListener('click', downloadPNG);
</script>
</body>
</html>